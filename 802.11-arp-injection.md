Step 1: Radiotap Header (PHY Layer)This is the required metadata for the Linux mac80211 subsystem (used by your mt76 driver).Key Fields: You need a minimal Radiotap header that specifies the length and, optionally, the transmission rate.Format: Must be constructed in Little Endian byte order.Step 2: 802.11 Data Frame Header (MAC Layer)This encapsulates the rest of the packet, acting as the wireless link layer. ARP responses are sent in Data frames.Frame Control: Set to Data (Type: 10, Subtype: 0000). The ToDS bit must be set to 1 and the FromDS bit set to 0 (since the packet is going To the Distribution System/AP).Value (Little Endian): 0x0842 or similar, depending on QoS (Quality of Service) and other flags. For simple Data, the value for ToDS=1, FromDS=0 is typically 0x02 (data) $\rightarrow$ 0x0802 (Little Endian).Address Fields (CRITICAL):Address 1 (Receiver): BSSID (MAC of the AP). This is the immediate receiver of the frame.Address 2 (Transmitter): Attacker MAC (Your device's MAC). This is the actual transmitter.Address 3 (Destination): Target MAC (The victim device's MAC). This is the final destination MAC on the wired network.Sequence Control: Must be a valid sequence number (though often 0x0000 is accepted for simple injection).Step 3: LLC/SNAP Header (Data Link Layer Encapsulation)802.11 Data frames that carry network-layer protocols (like IP, ARP) require an LLC (Logical Link Control) and SNAP (Subnetwork Access Protocol) header. This header contains the EtherType.LLC/SNAP Structure: The full header is 8 bytes long:DSAP, SSAP, Control: 0xAA, 0xAA, 0x03Organization Code: 0x00, 0x00, 0x00EtherType: ARP is 0x0806 (Big Endian).Step 4: ARP Packet Payload (Network Layer)This is the actual ARP response you want to send.Hardware Type: Ethernet (0x0001).Protocol Type: IPv4 (0x0800).Operation Code: ARP Reply (0x0002).Sender Hardware Address (SHA): Attacker MAC (The MAC you want the victim to associate with the Impersonated IP).Sender Protocol Address (SPA): Impersonated IP (e.g., Router IP).Target Hardware Address (THA): Target MAC (The victim's MAC).Target Protocol Address (TPA): Target IP (The victim's IP).ðŸš€ Execution Checklist (1-2-3)To successfully inject the packet using your mt76 driver:1. Configure the InterfaceAction: Put your wireless interface into Monitor Mode and set it to the correct channel of the target AP.Tool: iw or airmon-ng.2. Craft the PacketAction: Write the C code to create a single byte array containing: Radiotap $\rightarrow$ 802.11 Data Header $\rightarrow$ LLC/SNAP $\rightarrow$ ARP Reply.Tool: C structures with __attribute__((packed)) and manual byte placement.3. Inject the PacketAction: Use the pcap_sendpacket() function to inject the entire byte array onto the monitor mode interface.Tool: libpcap library.
